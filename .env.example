# -------------------------
# Telegram bot
# -------------------------
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
TELEGRAM_BOT_USERNAME=your_bot_username_without_at

# -------------------------
# Services
# -------------------------
# Default ports are configured in docker-compose.yml.
# When running a service locally (without Docker), use `PORT=...` per process.

# Telegram WebApp initData validation max age (seconds).
WEBAPP_AUTH_MAX_AGE_SEC=86400

# Extra diagnostic logging for Mini App issues (0/1).
DEBUG_WEBAPP_LOGS=0

# -------------------------
# Mini App URL (used by bot button)
# Must be HTTPS in Telegram.
# -------------------------
# Optional base used only as a fallback if WEB_APP_URL is not set.
FRONTEND_BASE_URL=http://localhost:3000
WEB_APP_URL=http://localhost:3000/

# Shared secret used by Next.js middleware to allow Mini App pages access.
MINIAPP_ACCESS_TOKEN=change_me

# -------------------------
# Database
# -------------------------
# Use `pg` for docker compose, `sqlite3` for local sqlite.
DB_CLIENT=pg

# For DB_CLIENT=pg (docker compose):
# DATABASE_URL=postgres://postgres:postgres@postgres:5432/animebot
DATABASE_URL=postgres://postgres:postgres@localhost:5432/animebot

# For DB_CLIENT=sqlite3 (local):
DB_PATH=./data/anime.sqlite3

# -------------------------
# Watch links (anicli_api)
# -------------------------
# URL of the internal `watch-api` service.
WATCH_API_URL=http://watch-api:8000

# Comma-separated list of allowed anicli sources (optional). Empty = allow any available extractor.
WATCH_SOURCES_ALLOWLIST=animego,animevost,anilibria

# TTL for python watch-api refs/caches (seconds).
WATCH_API_TTL_SEC=3600

# -------------------------
# Shikimori (replaces AniList for search)
# -------------------------
# Shikimori expects a stable User-Agent header. Optional but recommended.
SHIKIMORI_USER_AGENT=anime-list-tg-bot

# -------------------------
# Microservices (optional)
# -------------------------
# Shared secret used by gateway -> internal services (catalog/list).
# If empty, internal services allow requests (dev-friendly).
INTERNAL_SERVICE_TOKEN=

# Bot search source:
# - `catalog` (recommended): uses catalog-service canonical merged results
# - `local`: old source fan-out inside bot-service
BOT_SEARCH_MODE=catalog

# catalog-service in-memory cache tuning.
CATALOG_CACHE_TTL_MS=600000
CATALOG_CACHE_MAX=500

# -------------------------
# Postgres image (docker compose)
# -------------------------
POSTGRES_DB=animebot
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres

# -------------------------
# Telegram webhook (optional)
# -------------------------
# Example (prod): https://api.indexforge.site/webhook
TELEGRAM_WEBHOOK_URL=
TELEGRAM_WEBHOOK_SECRET=
TELEGRAM_WEBHOOK_PATH=/webhook

# -------------------------
# Reverse proxy (Traefik) - production VM
# -------------------------
# Example:
# MINI_HOST=mini.indexforge.site
# API_HOST=api.indexforge.site
# TRAEFIK_ACME_EMAIL=you@example.com
MINI_HOST=
API_HOST=
TRAEFIK_ACME_EMAIL=
TRAEFIK_ENTRYPOINT=websecure
TRAEFIK_CERT_RESOLVER=le
TRAEFIK_DOCKER_NETWORK=proxy
